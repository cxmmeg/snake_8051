C51 COMPILER V8.02   GAME                                                                  10/19/2013 13:32:26 PAGE 1   


C51 COMPILER V8.02, COMPILATION OF MODULE GAME
OBJECT MODULE PLACED IN game.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE game.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <reg52.h>
   2          #include "game.h"
   3          #include "ledarray.h"
   4          
   5          static unsigned char direct[]={2,2,2,2,2,2};//1:left  2:right  3:up  4:down
   6          static unsigned char snakex[]={0,1,2,3,4,5};
   7          static unsigned char snakey[]={0,0,0,0,0,0};
   8          static unsigned int snakelen=6;
   9          static unsigned char situation=0;//0: move  1: edge  2:eat
  10          
  11          unsigned char code die[]={//D
  12                                                            0x1E,0x32,0x62,0x42,0x42,0x62,0x32,0x1E,
  13                                                            //I
  14                                                            0x3C,0x18,0x18,0x18,0x18,0x18,0x18,0x3C,
  15                                                            //E
  16                                                            0x7E,0x06,0x06,0x7E,0x7E,0x06,0x06,0x7E,
  17                                                            //!
  18                                                            0x18,0x18,0x18,0x18,0x18,0x18,0x00,0x18
  19                                                            };
  20          
  21          extern unsigned char LEDarraydata[];
  22          
  23          sbit leftb=P3^4;
  24          sbit rightb=P3^5;
  25          sbit upb=P3^6;
  26          sbit downb=P3^7;
  27          
  28          void button(void){
  29   1              if(!leftb){
  30   2                      if(direct[snakelen-2]!=2){
  31   3                              direct[snakelen-1]=1;
  32   3                      }
  33   2              }else if(!rightb){
  34   2                      if(direct[snakelen-2]!=1){
  35   3                              direct[snakelen-1]=2;
  36   3                      }
  37   2              }else if(!upb){
  38   2                      if(direct[snakelen-2]!=4){
  39   3                              direct[snakelen-1]=3;
  40   3                      }
  41   2              }else if(!downb){
  42   2                      if(direct[snakelen-2]!=3){
  43   3                              direct[snakelen-1]=4;
  44   3                      }
  45   2              }
  46   1      }
  47          
  48          
  49          void move(void){
  50   1              unsigned char i;
  51   1              //determien situation
  52   1              i=snakelen;
  53   1              switch(direct[i-1]){
  54   2                      case 1: 
  55   2                              if(snakex[i-1]==0){
C51 COMPILER V8.02   GAME                                                                  10/19/2013 13:32:26 PAGE 2   

  56   3                                      situation=1;
  57   3                              }else if(read_dot(snakex[i-1]-1,snakey[i-1])){
  58   3                                      situation=1;
  59   3                              } 
  60   2                              break;
  61   2                      case 2: 
  62   2                              if(snakex[i-1]==15){
  63   3                                      situation=1;
  64   3                              }else if(read_dot(snakex[i-1]+1,snakey[i-1])){
  65   3                                      situation=1;
  66   3                              } 
  67   2                              break;
  68   2                      case 3: 
  69   2                              if(snakey[i-1]==0){
  70   3                                      situation=1;
  71   3                              }else if(read_dot(snakex[i-1],snakey[i-1]-1)){
  72   3                                      situation=1;
  73   3                              } 
  74   2                              break;
  75   2                      case 4: 
  76   2                              if(snakey[i-1]==15){
  77   3                                      situation=1;
  78   3                              }else if(read_dot(snakex[i-1]+1,snakey[i-1]+1)){
  79   3                                      situation=1;
  80   3                              } 
  81   2                              break;
  82   2                      default: break;         
  83   2              }
  84   1              if(situation==0){
  85   2                      for(i=0;i<snakelen;i++){
  86   3                              switch(direct[i]){
  87   4                                      case 1: snakex[i]-=1;break;
  88   4                                      case 2: snakex[i]+=1;break;
  89   4                                      case 3: snakey[i]-=1;break;
  90   4                                      case 4: snakey[i]+=1;break;
  91   4                                      default: break;
  92   4                              }
  93   3                              if(i!=snakelen-1){
  94   4                                      direct[i]=direct[i+1];
  95   4                              }
  96   3                      }
  97   2              }
  98   1      }
  99          
 100          void draw(void){
 101   1              unsigned char i;
 102   1              first_page();
 103   1              if(situation==0){
 104   2                      for(i=0;i<snakelen;i++){
 105   3                              set_dot(snakex[i],snakey[i]);
 106   3                      }
 107   2              }else if(situation==1){
 108   2                      for(i=0;i<32;i++){
 109   3                              LEDarraydata[i]=die[i];
 110   3                      }
 111   2              }
 112   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    391    ----
   CONSTANT SIZE    =     32    ----
C51 COMPILER V8.02   GAME                                                                  10/19/2013 13:32:26 PAGE 3   

   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     21       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
